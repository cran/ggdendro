<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Using the <code>ggdendro</code> package to plot dendrograms</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>Using the <code>ggdendro</code> package to plot dendrograms</h1>

<p>The <code>ggdendro</code> package makes it easy to extract dendrogram and tree diagrams into a list of data frames.  You can then use this list to create these types of plots using the <code>ggplot2</code> package</p>

<h2>Introduction</h2>

<p>The <code>ggdendro</code> package provides a general framework to extract the plot data for dendrograms and tree diagrams.</p>

<p>It does this by providing generic function <code>dendro_data()</code> that extracts the appropriate segment and label data, returning the data as a list of data frames.  </p>

<p>You can access these data frames using three accessor functions:</p>

<ul>
<li><code>segment()</code></li>
<li><code>label()</code></li>
<li><code>leaf_label()</code></li>
</ul>

<p>The package also provides two convenient wrapper functions:</p>

<ul>
<li><code>ggdendrogram()</code> is a wrapper around <code>ggplot()</code> to create a dendrogram using a single line of code.  The resulting object is of class <code>ggplot</code>, so can be manipulated using the <code>ggplot2</code> tools.</li>
<li><code>theme_dendro()</code> is a <code>ggplot2</code> theme with a blank canvas, i.e. no axes, axis labels or tick marks.</li>
</ul>

<p>The <code>ggplot2</code> package doesn&#39;t get loaded automatically, so remember to load it first: </p>

<pre><code class="r">library(ggplot2)
library(ggdendro)
</code></pre>

<h2>Using the <code>ggdendrogram()</code> wrapper</h2>

<p>The <code>ggdendro</code> package extracts the plot data from dendrogram objects.  Sometimes it is useful to have fine-grained control over the plot.  Other times it might be more convenient to have a simple wrapper around <code>ggplot()</code> to produce a dendrogram with a small amount of code.</p>

<p>The function <code>ggdendrogram()</code> provides such a wrapper to produce a plot with a single line of code.  It provides a few options for controlling the display of line segments, labels and plot rotation (rotated by 90 degrees or not).  </p>

<pre><code class="r">hc &lt;- hclust(dist(USArrests), &quot;ave&quot;)
ggdendrogram(hc, rotate = FALSE, size = 2)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk dendrogram"/> </p>

<p>The next section shows how to take full control over the data extraction and subsequent plotting.</p>

<h2>Extracting the dendrogram plot data using <code>dendro_data()</code></h2>

<p>The <code>hclust()</code> and <code>dendrogram()</code> functions in R makes it easy to plot the results of hierarchical cluster analysis and other dendrograms in R.  However, it is hard to extract the data from this analysis to customise these plots, since the <code>plot()</code> functions for both these classes prints directly without the option of returning the plot data.  </p>

<pre><code class="r">model &lt;- hclust(dist(USArrests), &quot;ave&quot;)
dhc &lt;- as.dendrogram(model)
# Rectangular lines
ddata &lt;- dendro_data(dhc, type = &quot;rectangle&quot;)
p &lt;- ggplot(segment(ddata)) + 
  geom_segment(aes(x = x, y = y, xend = xend, yend = yend)) + 
  coord_flip() + 
  scale_y_reverse(expand = c(0.2, 0))
p
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk dendro1"/> </p>

<p>Of course, using <code>ggplot2</code> to create the dendrogram means one has full control over the appearance of the plot.  For example, here is the same data, but this time plotted horizontally with a clean background.  In <code>ggplot2</code> this means
passing a number of options to <code>theme</code>.  The <code>ggdendro</code> packages exports a function, <code>theme_dendro()</code> that wraps these options into a convenient function.</p>

<pre><code class="r">p + 
  coord_flip() + 
  theme_dendro()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk dendro-2"/> </p>

<p>You can also draw dendrograms with triangular line segments (instead of rectangular segments).  For example:</p>

<pre><code class="r">ddata &lt;- dendro_data(dhc, type = &quot;triangle&quot;)
ggplot(segment(ddata)) + 
  geom_segment(aes(x = x, y = y, xend = xend, yend = yend)) + 
  coord_flip() + 
  scale_y_reverse(expand = c(0.2, 0)) +
  theme_dendro()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk dendro-3"/> </p>

<h2>Regression tree diagrams</h2>

<p>The <code>tree()</code> function in package <code>tree</code> creates tree diagrams.  To extract the plot data for these diagrams using <code>ggdendro</code>, you use the the same idiom as for plotting dendrograms: </p>

<pre><code class="r">if(require(tree)){
  data(cpus, package = &quot;MASS&quot;)
  model &lt;- tree(log10(perf) ~ syct + mmin + mmax + cach + chmin + chmax, 
                data = cpus)
  tree_data &lt;- dendro_data(model)
  ggplot(segment(tree_data)) +
    geom_segment(aes(x = x, y = y, xend = xend, yend = yend, size = n), 
                 colour = &quot;blue&quot;, alpha = 0.5) +
    scale_size(&quot;n&quot;) +
    geom_text(data = label(tree_data), 
              aes(x = x, y = y, label = label), vjust = -0.5, size = 3) +
    geom_text(data = leaf_label(tree_data), 
              aes(x = x, y = y, label = label), vjust = 0.5, size = 2) +
    theme_dendro()
}
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk tree"/> </p>

<h2>Classification tree diagrams</h2>

<p>The <code>rpart()</code> function in package <code>rpart</code> creates classification diagrams.  To extract the plot data for these diagrams using <code>ggdendro</code> follows the same basic pattern as dendrograms: </p>

<pre><code class="r">if(require(rpart)){
  model &lt;- rpart(Kyphosis ~ Age + Number + Start, 
                 method = &quot;class&quot;, data = kyphosis)
  ddata &lt;- dendro_data(model)
  ggplot() + 
    geom_segment(data = ddata$segments, 
                 aes(x = x, y = y, xend = xend, yend = yend)) + 
    geom_text(data = ddata$labels, 
              aes(x = x, y = y, label = label), size = 3, vjust = 0) +
    geom_text(data = ddata$leaf_labels, 
              aes(x = x, y = y, label = label), size = 3, vjust = 1) +
    theme_dendro()
}
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk rpart"/> </p>

<h2>Twins diagrams: agnes and diana</h2>

<p>The <code>clusters</code> package allows you to draw agnes and diana diagrams.</p>

<pre><code class="r">if(require(cluster)){
  model &lt;- agnes(votes.repub, metric = &quot;manhattan&quot;, stand = TRUE)
  dg &lt;- as.dendrogram(model)
  ggdendrogram(dg)

  model &lt;- diana(votes.repub, metric = &quot;manhattan&quot;, stand = TRUE)
  dg &lt;- as.dendrogram(model)
  ggdendrogram(dg)
}
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAilBMVEUAAABNTU1NTW5NTY5Nbm5NbqtNjo5NjshuTU1uTW5uTY5ubqtujshuq8huq+SOTU2OTW6OTY6Obm6ObquOjsiOyOSOyP+rbk2rbm6rbo6rjqurq+Sr5P/Ijk3Ijo7I/8jI/+TI///kq27kq47kyI7k5Kvk/8jk/+Tk////yI7/5Kv//8j//+T///+IVEcmAAAACXBIWXMAAAsSAAALEgHS3X78AAAYGUlEQVR4nO2dC5cbqRGFrXWc8eYxs46dcZxYzo6S7M5L///vRVI3UMCFpiW6BVP37onPSI2g4ONRFEh5t6dU6t21DaCuI4JXKoJXKoJXKoJXKoJXKoJXKoJXKoJXKoJXKoJXKoJXKoJXKoJXKoJXKoJXKoJXKoJXKoJXKoJXKoJXKoJXKoJXqjrg37WpKnV7o6oEvkoutdWmVY2I4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JWK4JXKNM52c9Tthbm0pTatakRj47x8fjz8+/rt4aJcGlObVjUiglcq0zg7TvW6ROdOqdxU/3K3+en7Zbk0pjatakQO/I8HrvGKZMDf3RK8KtnG2W1uXr/eX5pLU2rTqkZE506pCF6p7Bp/2se/5xqvRbZxtueu714uTalNqxoRp3qlInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilInilMo2z3Rx1e2Eu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" alt="plot of chunk twins"/> </p>

<h2>Conclusion</h2>

<p>The <code>ggdendro</code> package makes it easy to extract the line segment and label data from <code>hclust</code>, <code>dendrogram</code> and <code>tree</code> objects.</p>

</body>

</html>
